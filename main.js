img = "";
status = "";
objects = [];

function setup() {
    canvas = createCanvas(640, 420);
    canvas.center();
    objectdetector = ml5.objectDetector('cocossd', modelloaded);
    document.getElementById("status").innerHTML = "status : detecting object";
}

function preload(){
    img = loadImage('data:image/jpeg;base64,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');
}

function draw() {
    image(img, 0, 0, 640, 420);
    if (status != "") {
        for (i = 0; i < objects.length; i++) {
            document.getElementById("status").innerHTML = "status : object detected";
            fill("#ff0000");
            percent = floor(objects[i].confidence * 100);
            text(objects[i].label + " " + percent + "%", objects[i].x + 15, objects[i].y + 15);
            noFill();
            stroke("#ff0000");
            rect(objects[i].x, objects[i].y, objects[i].width, objects[i].height);
        }
    }
}

function modelloaded() {
    console.log("model loaded!");
    status = true;
    objectdetector.detect(img, gotresults);
}

function gotresults(error, results) {
    if (error) {
        console.log(error);
    }
    console.log(results);
    objects = results;
}